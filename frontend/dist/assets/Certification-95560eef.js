import{_ as O,m as Q,W as $,X as ee,Y as te,Z as ae,g as le,r as m,D as ie,o as oe,i as d,j as y,k,q as t,w as i,y as f,x as r,n as o,B as j,I as N,F as X,t as Y,z as u}from"./index-94722956.js";import{r as Z}from"./request-95526739.js";const ne={name:"CertificationManage",components:{Medal:Q,Bell:$,Share:ee,CopyDocument:te,Link:ae},setup(){const F=le(),e=m("application"),R=m(!1);m(null);const l=m(!1),h=m([]),U=m(!1),x=m(!1),w=m({}),v=m(""),V=m([{id:1,standardName:"服装设计师初级认证",jobType:"设计师",level:"初级",status:3,createTime:"2024-01-15 10:30:00",updateTime:"2024-01-20 14:20:00"},{id:2,standardName:"服装设计师中级认证",jobType:"设计师",level:"中级",status:1,createTime:"2024-02-10 09:15:00",updateTime:"2024-02-10 09:15:00"}]),s=m([{id:1,name:"服装设计师初级证书",certificateNo:"AC-2024-0001",standardName:"服装设计师初级认证",jobType:"设计师",level:"初级",issueDate:"2024-01-20",expireDate:"2027-01-20",status:1}]),T=m([{id:1,name:"服装设计师初级认证",jobType:"设计师",level:"初级",description:"针对服装设计师的初级技能认证，考核设计基础理论和基本设计能力"},{id:2,name:"服装设计师中级认证",jobType:"设计师",level:"中级",description:"针对服装设计师的中级技能认证，考核设计创新能力和项目实践经验"},{id:3,name:"服装设计师高级认证",jobType:"设计师",level:"高级",description:"针对服装设计师的高级技能认证，考核设计理念和品牌策划能力"}]),q=ie({jobType:"",level:"",standardId:"",description:""}),A={jobType:[{required:!0,message:"请选择岗位类型",trigger:"change"}],level:[{required:!0,message:"请选择认证等级",trigger:"change"}],standardId:[{required:!0,message:"请选择认证项目",trigger:"change"}]},p=n=>({0:"待审核",1:"待考试",2:"待评审",3:"通过",4:"不通过"})[n]||"未知",L=n=>({0:"info",1:"warning",2:"warning",3:"success",4:"danger"})[n]||"info",D=()=>{R.value=!0},M=()=>{R.value=!1,f.success("认证申请提交成功，待审核")},P=n=>{f.info("查看详情功能开发中")},_=n=>{F.push({path:"/personal/exam",query:{applicationId:n.id,examId:n.standardId||1}})},S=n=>{f.info("上传实操功能开发中")},C=n=>{f.info("下载证书功能开发中")},z=n=>{f.info("验证证书功能开发中")},W=async n=>{var c;try{const g=((c=(await Z.get("/api/admin/certification/certificate/share-link",{params:{certificateId:n.id}})).data)==null?void 0:c.shareLink)||`https://apparelcert.com/verify/${n.certificateNo}`;E(n,g)}catch{const g=`https://apparelcert.com/verify/${n.certificateNo}`;E(n,g)}},E=(n,c)=>{x.value=!0,w.value=n,v.value=c},a=async()=>{try{await navigator.clipboard.writeText(v.value),f.success("链接已复制到剪贴板")}catch{const c=document.createElement("input");c.value=v.value,document.body.appendChild(c),c.select(),document.execCommand("copy"),document.body.removeChild(c),f.success("链接已复制到剪贴板")}},b=n=>{const c=w.value,B=`我获得了${c.name}认证！证书编号：${c.certificateNo}`,g=v.value;let I="";switch(n){case"weibo":I=`https://service.weibo.com/share/share.php?url=${encodeURIComponent(g)}&title=${encodeURIComponent(B)}`;break;case"wechat":f.info("请使用微信扫描二维码分享");return;case"linkedin":I=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(g)}`;break;case"twitter":I=`https://twitter.com/intent/tweet?text=${encodeURIComponent(B)}&url=${encodeURIComponent(g)}`;break}I&&window.open(I,"_blank","width=600,height=400")},H=n=>{f.info("查看认证标准详情功能开发中")},G=async()=>{U.value=!0;try{const n=await Z.get("/api/admin/certification/certificate/expiring",{params:{daysBeforeExpire:30}});n.data&&n.data.length>0?(h.value=n.data.map(c=>({...c,remainingDays:Math.ceil((new Date(c.expireDate)-new Date)/(1e3*60*60*24))})),l.value=!0):f.success("所有证书状态正常")}catch{h.value=[{id:1,name:"服装设计师初级证书",certificateNo:"AC-2024-0001",expireDate:"2025-01-25",remainingDays:28}],h.value.length>0&&(l.value=!0)}finally{U.value=!1}},J=async n=>{try{await Z.post("/api/admin/certification/certificate/renew",null,{params:{certificateId:n.id,years:1}}),f.success("证书续期申请已提交"),l.value=!1}catch{f.info("续期功能开发中")}},K=()=>{e.value="certificate",l.value=!1};return oe(()=>{G()}),{activeTab:e,applyDialogVisible:R,applyForm:q,applyRules:A,applications:V,certificates:s,standards:T,getStatusText:p,getStatusTagType:L,applyCertification:D,submitApplication:M,viewApplication:P,startExam:_,uploadPractical:S,downloadCertificate:C,verifyCertificate:z,shareCertificate:W,viewStandard:H,expiryReminderVisible:l,expiringCertificates:h,checkingExpiry:U,checkExpiringCertificates:G,renewCertificate:J,goToRenewalPage:K,shareDialogVisible:x,currentShareCert:w,currentShareLink:v,copyShareLink:a,shareToSocial:b}}},se={class:"certification-container"},re={class:"expiry-reminder-content"},de={class:"expiring-cert-list"},ce={class:"cert-info-row"},pe={class:"cert-details"},ue={class:"cert-name"},me={class:"cert-number"},fe={class:"cert-expiry"},ye={class:"expiry-date"},ve={class:"card-header"},_e={class:"header-actions"},be={class:"certification-tabs"},ge={class:"certificate-list"},we={class:"certificate-header"},Ce={class:"certificate-content"},ke={class:"cert-info"},he={class:"value"},xe={class:"cert-info"},Ve={class:"value"},Te={class:"cert-info"},De={class:"value"},Se={class:"cert-info"},Ie={class:"value"},je={class:"cert-info"},Ne={class:"value"},Fe={class:"cert-info"},Re={class:"value"},Ue={class:"certificate-actions"},Le={class:"dialog-footer"},Me={key:0,class:"share-dialog-content"},ze={class:"share-cert-preview"},Ee={class:"cert-preview-header"},Be={class:"cert-preview-info"},qe={class:"share-link-section"},Ae={class:"share-link-input"},Pe={class:"share-social-section"},We={class:"social-buttons"};function Xe(F,e,R,l,h,U){const x=d("el-alert"),w=d("Medal"),v=d("el-icon"),V=d("el-tag"),s=d("el-button"),T=d("el-dialog"),q=d("Bell"),A=d("el-badge"),p=d("el-table-column"),L=d("el-table"),D=d("el-tab-pane"),M=d("el-card"),P=d("el-tabs"),_=d("el-option"),S=d("el-select"),C=d("el-form-item"),z=d("el-input"),W=d("el-form"),E=d("CopyDocument");return y(),k("div",se,[t(T,{modelValue:l.expiryReminderVisible,"onUpdate:modelValue":e[1]||(e[1]=a=>l.expiryReminderVisible=a),title:"证书有效期提醒",width:"500px"},{footer:i(()=>[t(s,{onClick:e[0]||(e[0]=a=>l.expiryReminderVisible=!1)},{default:i(()=>[...e[18]||(e[18]=[r("稍后处理",-1)])]),_:1}),t(s,{type:"primary",onClick:l.goToRenewalPage},{default:i(()=>[...e[19]||(e[19]=[r("查看全部证书",-1)])]),_:1},8,["onClick"])]),default:i(()=>[o("div",re,[l.expiringCertificates.length>0?(y(),j(x,{key:0,title:"您有证书即将过期",type:"warning",closable:!1,"show-icon":""},{default:i(()=>[...e[16]||(e[16]=[o("p",null,"以下证书将在30天内过期，请及时续期：",-1)])]),_:1})):N("",!0),o("div",de,[(y(!0),k(X,null,Y(l.expiringCertificates,a=>(y(),k("div",{key:a.id,class:"expiring-cert-item"},[o("div",ce,[t(v,{class:"cert-icon"},{default:i(()=>[t(w)]),_:1}),o("div",pe,[o("span",ue,u(a.name),1),o("span",me,u(a.certificateNo),1)])]),o("div",fe,[t(V,{type:a.remainingDays<=7?"danger":"warning",size:"small"},{default:i(()=>[r(" 剩余 "+u(a.remainingDays)+" 天 ",1)]),_:2},1032,["type"]),o("span",ye,"到期："+u(a.expireDate),1)]),t(s,{type:"primary",size:"small",onClick:b=>l.renewCertificate(a)},{default:i(()=>[...e[17]||(e[17]=[r("立即续期",-1)])]),_:1},8,["onClick"])]))),128))])])]),_:1},8,["modelValue"]),t(M,{shadow:"hover"},{header:i(()=>[o("div",ve,[e[22]||(e[22]=o("h2",null,"技能认证管理",-1)),o("div",_e,[t(A,{value:l.expiringCertificates.length,hidden:l.expiringCertificates.length===0,class:"expiry-badge"},{default:i(()=>[t(s,{onClick:l.checkExpiringCertificates,loading:l.checkingExpiry},{default:i(()=>[t(v,null,{default:i(()=>[t(q)]),_:1}),e[20]||(e[20]=r(" 有效期检查 ",-1))]),_:1},8,["onClick","loading"])]),_:1},8,["value","hidden"]),t(s,{type:"primary",onClick:l.applyCertification},{default:i(()=>[...e[21]||(e[21]=[r("申请认证",-1)])]),_:1},8,["onClick"])])])]),default:i(()=>[o("div",be,[t(P,{modelValue:l.activeTab,"onUpdate:modelValue":e[2]||(e[2]=a=>l.activeTab=a),type:"card"},{default:i(()=>[t(D,{label:"认证申请",name:"application"},{default:i(()=>[t(L,{data:l.applications,style:{width:"100%"}},{default:i(()=>[t(p,{prop:"id",label:"申请ID",width:"100"}),t(p,{prop:"standardName",label:"认证项目",width:"200"}),t(p,{prop:"jobType",label:"岗位类型",width:"120"}),t(p,{prop:"level",label:"等级",width:"100"}),t(p,{prop:"status",label:"状态",width:"120"},{default:i(a=>[t(V,{type:l.getStatusTagType(a.row.status)},{default:i(()=>[r(u(l.getStatusText(a.row.status)),1)]),_:2},1032,["type"])]),_:1}),t(p,{prop:"createTime",label:"申请时间",width:"180"}),t(p,{prop:"updateTime",label:"更新时间",width:"180"}),t(p,{label:"操作",width:"200",fixed:"right"},{default:i(a=>[t(s,{type:"primary",size:"small",onClick:b=>l.viewApplication(a.row)},{default:i(()=>[...e[23]||(e[23]=[r("查看详情",-1)])]),_:1},8,["onClick"]),a.row.status===1?(y(),j(s,{key:0,type:"success",size:"small",onClick:b=>l.startExam(a.row)},{default:i(()=>[...e[24]||(e[24]=[r("开始考试",-1)])]),_:1},8,["onClick"])):N("",!0),a.row.status===2?(y(),j(s,{key:1,type:"warning",size:"small",onClick:b=>l.uploadPractical(a.row)},{default:i(()=>[...e[25]||(e[25]=[r("上传实操",-1)])]),_:1},8,["onClick"])):N("",!0)]),_:1})]),_:1},8,["data"])]),_:1}),t(D,{label:"我的证书",name:"certificate"},{default:i(()=>[o("div",ge,[(y(!0),k(X,null,Y(l.certificates,a=>(y(),j(M,{key:a.id,shadow:"hover",class:"certificate-item"},{default:i(()=>[o("div",we,[o("h3",null,u(a.name),1),t(V,{type:a.status===1?"success":"warning"},{default:i(()=>[r(u(a.status===1?"有效":"已过期"),1)]),_:2},1032,["type"])]),o("div",Ce,[o("div",ke,[e[26]||(e[26]=o("span",{class:"label"},"证书编号：",-1)),o("span",he,u(a.certificateNo),1)]),o("div",xe,[e[27]||(e[27]=o("span",{class:"label"},"认证项目：",-1)),o("span",Ve,u(a.standardName),1)]),o("div",Te,[e[28]||(e[28]=o("span",{class:"label"},"岗位类型：",-1)),o("span",De,u(a.jobType),1)]),o("div",Se,[e[29]||(e[29]=o("span",{class:"label"},"等级：",-1)),o("span",Ie,u(a.level),1)]),o("div",je,[e[30]||(e[30]=o("span",{class:"label"},"颁发日期：",-1)),o("span",Ne,u(a.issueDate),1)]),o("div",Fe,[e[31]||(e[31]=o("span",{class:"label"},"有效期至：",-1)),o("span",Re,u(a.expireDate),1)])]),o("div",Ue,[t(s,{type:"primary",size:"small",onClick:b=>l.downloadCertificate(a)},{default:i(()=>[...e[32]||(e[32]=[r("下载证书",-1)])]),_:1},8,["onClick"]),t(s,{type:"success",size:"small",onClick:b=>l.verifyCertificate(a)},{default:i(()=>[...e[33]||(e[33]=[r("验证证书",-1)])]),_:1},8,["onClick"]),t(s,{size:"small",onClick:b=>l.shareCertificate(a)},{default:i(()=>[...e[34]||(e[34]=[r("分享证书",-1)])]),_:1},8,["onClick"])])]),_:2},1024))),128))])]),_:1}),t(D,{label:"认证标准",name:"standard"},{default:i(()=>[t(L,{data:l.standards,style:{width:"100%"}},{default:i(()=>[t(p,{prop:"id",label:"标准ID",width:"100"}),t(p,{prop:"name",label:"认证项目",width:"200"}),t(p,{prop:"jobType",label:"岗位类型",width:"120"}),t(p,{prop:"level",label:"等级",width:"100"}),t(p,{prop:"description",label:"描述"}),t(p,{label:"操作",width:"150",fixed:"right"},{default:i(a=>[t(s,{type:"primary",size:"small",onClick:b=>l.viewStandard(a.row)},{default:i(()=>[...e[35]||(e[35]=[r("查看详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue"])])]),_:1}),t(T,{modelValue:l.applyDialogVisible,"onUpdate:modelValue":e[8]||(e[8]=a=>l.applyDialogVisible=a),title:"申请技能认证",width:"600px"},{footer:i(()=>[o("div",Le,[t(s,{onClick:e[7]||(e[7]=a=>l.applyDialogVisible=!1)},{default:i(()=>[...e[36]||(e[36]=[r("取消",-1)])]),_:1}),t(s,{type:"primary",onClick:l.submitApplication},{default:i(()=>[...e[37]||(e[37]=[r("提交申请",-1)])]),_:1},8,["onClick"])])]),default:i(()=>[t(W,{ref:"applyFormRef",model:l.applyForm,rules:l.applyRules,"label-width":"120px"},{default:i(()=>[t(C,{label:"岗位类型",prop:"jobType"},{default:i(()=>[t(S,{modelValue:l.applyForm.jobType,"onUpdate:modelValue":e[3]||(e[3]=a=>l.applyForm.jobType=a),placeholder:"请选择岗位类型"},{default:i(()=>[t(_,{label:"设计师",value:"设计师"}),t(_,{label:"打版师",value:"打版师"}),t(_,{label:"质检员",value:"质检员"}),t(_,{label:"导购",value:"导购"})]),_:1},8,["modelValue"])]),_:1}),t(C,{label:"认证等级",prop:"level"},{default:i(()=>[t(S,{modelValue:l.applyForm.level,"onUpdate:modelValue":e[4]||(e[4]=a=>l.applyForm.level=a),placeholder:"请选择认证等级"},{default:i(()=>[t(_,{label:"初级",value:"初级"}),t(_,{label:"中级",value:"中级"}),t(_,{label:"高级",value:"高级"})]),_:1},8,["modelValue"])]),_:1}),t(C,{label:"认证项目",prop:"standardId"},{default:i(()=>[t(S,{modelValue:l.applyForm.standardId,"onUpdate:modelValue":e[5]||(e[5]=a=>l.applyForm.standardId=a),placeholder:"请选择认证项目"},{default:i(()=>[F.standard.jobType===l.applyForm.jobType&&F.standard.level===l.applyForm.level?(y(!0),k(X,{key:0},Y(l.standards,a=>(y(),j(_,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128)):N("",!0)]),_:1},8,["modelValue"])]),_:1}),t(C,{label:"申请说明"},{default:i(()=>[t(z,{modelValue:l.applyForm.description,"onUpdate:modelValue":e[6]||(e[6]=a=>l.applyForm.description=a),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),t(T,{modelValue:l.shareDialogVisible,"onUpdate:modelValue":e[15]||(e[15]=a=>l.shareDialogVisible=a),title:"分享证书",width:"500px"},{footer:i(()=>[t(s,{onClick:e[14]||(e[14]=a=>l.shareDialogVisible=!1)},{default:i(()=>[...e[46]||(e[46]=[r("关闭",-1)])]),_:1})]),default:i(()=>[l.currentShareCert?(y(),k("div",Me,[o("div",ze,[o("div",Ee,[t(v,{class:"cert-medal"},{default:i(()=>[t(w)]),_:1}),o("div",Be,[o("h3",null,u(l.currentShareCert.name),1),o("p",null,"证书编号："+u(l.currentShareCert.certificateNo),1)])])]),o("div",qe,[e[39]||(e[39]=o("h4",null,"分享链接",-1)),o("div",Ae,[t(z,{modelValue:l.currentShareLink,"onUpdate:modelValue":e[9]||(e[9]=a=>l.currentShareLink=a),readonly:""},{append:i(()=>[t(s,{onClick:l.copyShareLink},{default:i(()=>[t(v,null,{default:i(()=>[t(E)]),_:1}),e[38]||(e[38]=r(" 复制 ",-1))]),_:1},8,["onClick"])]),_:1},8,["modelValue"])])]),o("div",Pe,[e[44]||(e[44]=o("h4",null,"分享到社交平台",-1)),o("div",We,[t(s,{class:"social-btn weibo",onClick:e[10]||(e[10]=a=>l.shareToSocial("weibo"))},{default:i(()=>[...e[40]||(e[40]=[o("span",{class:"social-icon"},"微博",-1)])]),_:1}),t(s,{class:"social-btn wechat",onClick:e[11]||(e[11]=a=>l.shareToSocial("wechat"))},{default:i(()=>[...e[41]||(e[41]=[o("span",{class:"social-icon"},"微信",-1)])]),_:1}),t(s,{class:"social-btn linkedin",onClick:e[12]||(e[12]=a=>l.shareToSocial("linkedin"))},{default:i(()=>[...e[42]||(e[42]=[o("span",{class:"social-icon"},"LinkedIn",-1)])]),_:1}),t(s,{class:"social-btn twitter",onClick:e[13]||(e[13]=a=>l.shareToSocial("twitter"))},{default:i(()=>[...e[43]||(e[43]=[o("span",{class:"social-icon"},"Twitter",-1)])]),_:1})])]),t(x,{title:"温馨提示",type:"info",closable:!1,"show-icon":"",style:{"margin-top":"20px"}},{default:i(()=>[...e[45]||(e[45]=[r(" 分享链接可供他人验证您的证书真伪，有效期为30天。 ",-1)])]),_:1})])):N("",!0)]),_:1},8,["modelValue"])])}const Ge=O(ne,[["render",Xe],["__scopeId","data-v-ae14ba6e"]]);export{Ge as default};
