import{_ as Oe,m as Ke,a7 as Qe,a8 as He,a9 as Xe,aa as Ye,ab as Ze,r as v,K as ve,h as $e,o as el,L as ye,j as y,k,n as S,t as a,w as o,D as c,a5 as pe,E as ge,y as u,q as i,I as O,Q as K,F as ue,v as fe,G as g}from"./index-3d929bd0.js";import{r as V}from"./request-9595d616.js";function be(f){return V({url:"/personal/certification/list",method:"get",params:f})}function ll(f){return V({url:"/admin/certification/certificate/by-user",method:"get",params:f})}function tl(f){return V({url:"/admin/certification/standard",method:"get",params:f})}function al(f){return V({url:"/personal/certification",method:"post",data:f})}function ol(f){return V({url:"/admin/certification/certificate/expiring",method:"get",params:f})}function il(f){return V({url:"/admin/certification/certificate/renew",method:"post",params:f})}function nl(f){return V({url:"/admin/certification/certificate/share-link",method:"get",params:{certificateId:f}})}function _e(f,l,M){const t=new FormData;return t.append("file",f),t.append("certificationId",l),V({url:"/upload/practical",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"},onUploadProgress:P=>{if(M&&P.total){const z=Math.round(P.loaded*100/P.total);M(z)}}})}function rl(f){return V({url:"/personal/certification/detail",method:"get",params:{id:f}})}function sl(f){return V({url:"/admin/certification/certificate/export",method:"get",params:{certificateId:f}})}function dl(f){return V({url:"/admin/certification/certificate/verify",method:"get",params:{certificateNumber:f}})}const cl={name:"CertificationManage",components:{Medal:Ke,Bell:Qe,Share:He,CopyDocument:Xe,Link:Ye,UploadFilled:Ze},setup(){const f=v("application"),l=v(!1),M=v(null),t=v(null),P=v([]),z=v(null),B=v(!1),G=v(!1),U=v([]),W=v(!1),m=v(!1),A=v(null),Q=v(""),te=v(!1),_=v(null),ae=v(null),E=v([]),D=v(null),J=v(0),w=v(""),q=v(!1),h=v(""),oe=ve({}),Z=v([]),$=v([]),T=v([]),C=ve({jobType:"",level:"",standardId:"",description:""}),H={jobType:[{required:!0,message:"请选择岗位类型",trigger:"change"}],level:[{required:!0,message:"请选择认证等级",trigger:"change"}],standardId:[{required:!0,message:"请选择认证项目",trigger:"change"}]},ie=()=>{P.value=[],z.value=null},ee=()=>{var e,r;C.jobType="",C.level="",C.standardId="",C.description="",(r=(e=M.value)==null?void 0:e.clearValidate)==null||r.call(e),ie()},ne=()=>{B.value=!1,ee()},n=()=>{c.warning("只能上传一张图片")},N=e=>{if(!(e!=null&&e.raw))return!1;const r=["image/jpeg","image/png","image/webp"],d=(e.name||"").toLowerCase(),p=d.endsWith(".jpg")||d.endsWith(".jpeg")||d.endsWith(".png")||d.endsWith(".webp");if(!r.includes(e.raw.type)&&!p)return c.error("仅支持 JPG/JPEG/PNG/WEBP 图片"),!1;const s=10*1024*1024;return e.raw.size>s?(c.error("图片大小不能超过 10MB"),!1):(z.value=e.raw,P.value=[e],!0)},X={designer:"设计师",patternmaker:"打版师",inspector:"质检员",sales:"导购"},Y={1:"初级",2:"中级",3:"高级",4:"专家级"},L=e=>{const r=String(e||"").trim();return{designer:"designer",patternmaker:"patternmaker",inspector:"inspector",sales:"sales",设计师:"designer",打版师:"patternmaker",质检员:"inspector",导购:"sales"}[r]||r},F=e=>{const r=Number(e);return Number.isNaN(r)?null:r},we=e=>({...e,jobType:L(e.type||e.jobType),jobTypeLabel:X[L(e.type||e.jobType)]||e.type||e.jobType,level:F(e.level),levelLabel:Y[F(e.level)]||e.level}),re=async()=>{var d;const e=await tl({page:1,size:100}),r=((d=e.data)==null?void 0:d.records)||e.data||[];T.value=r.map(we)},he=$e(()=>{const e=L(C.jobType),r=C.level!==""?F(C.level):null,d=T.value.filter(s=>{const b=L(s.jobType||s.type);return e?b===e:!0}),p=d.filter(s=>r===null?!0:F(s.level)===r);if(p.length>0)return p;if(d.length>0)return d;if(r!==null){const s=T.value.filter(b=>F(b.level)===r);if(s.length>0)return s}return T.value}),Ce=e=>{const r=e.jobTypeLabel||X[L(e.jobType||e.type)]||"-",d=e.levelLabel||Y[F(e.level)]||"-";return`${e.name||"未命名项目"}（${r} / ${d}）`},ke=e=>e?/^https?:\/\//i.test(e)?e:`${window.location.origin}${e.startsWith("/")?"":"/"}${e}`:"",Te=e=>Number(e==null?void 0:e.status)!==3,xe=e=>{const r=ke((e==null?void 0:e.practicalFileUrl)||"");if(!r){c.warning("当前申请还未上传认证图片");return}window.open(r,"_blank")},me=e=>({0:"待提交图片",1:"待审核",2:"审核未通过",3:"审核通过",4:"审核未通过"})[e]||"未知",Ve=e=>({0:"info",1:"warning",2:"danger",3:"success",4:"danger"})[e]||"info",se=async()=>{try{const e=Number(pe("/personal")||0),[r,d]=await Promise.all([be({userId:e}),ll({userId:e})]);await re();const p=(s,b)=>{const x=L(s),le=F(b),R=T.value.find(I=>L(I.type||I.jobType)===x&&F(I.level)===le);return(R==null?void 0:R.id)||null};Z.value=(r.data||[]).map(s=>({id:s.id,standardId:p(s.certificationType,s.level),standardName:s.projectName||"未命名项目",jobTypeLabel:X[L(s.certificationType)]||s.certificationType,levelLabel:Y[s.level]||s.level,status:s.status,createTime:s.applyTime,updateTime:s.reviewTime,practicalFileUrl:s.practicalFileUrl||""})),$.value=(d.data||[]).map(s=>{const b=X[s.certificationType]||s.certificationType,x=Y[s.level]||s.level;return{...s,name:`${b}${x?`（${x}）`:""}`,jobTypeLabel:b,levelLabel:x,certificateNo:s.certificateNumber,standardName:s.certificationType,status:s.certificateStatus==="有效"?1:0}})}catch(e){c.error("数据加载失败，请稍后重试。"),console.error("Failed to fetch data:",e)}},Le=async()=>{try{await re()}catch{c.error("加载认证标准失败，请稍后重试");return}if(T.value.length===0){c.warning("暂无可申请的认证标准");return}ee(),l.value=!0},Fe=async()=>{if(M.value){if(!z.value){c.warning("请先上传认证图片");return}await M.value.validate(async e=>{var r,d;if(e){B.value=!0;try{const p=Number(pe("/personal")||0),s=T.value.find(I=>String(I.id)===String(C.standardId)),b=L((s==null?void 0:s.type)||(s==null?void 0:s.jobType)||C.jobType),x=F((s==null?void 0:s.level)??C.level);if(!b||x===null){c.error("认证项目信息不完整，请重新选择");return}const le=await al({userId:p,certificationType:b,level:x,projectName:(s==null?void 0:s.name)||""});let R=(r=le==null?void 0:le.data)==null?void 0:r.id;if(!R){const I=await be({userId:p});R=(d=((I==null?void 0:I.data)||[]).filter(j=>L(j==null?void 0:j.certificationType)===b&&F(j==null?void 0:j.level)===x).sort((j,ce)=>Number((ce==null?void 0:ce.id)||0)-Number((j==null?void 0:j.id)||0))[0])==null?void 0:d.id}if(!R)throw new Error("未获取到申请ID");await _e(z.value,R),c.success("认证申请提交成功，图片已上传，待管理员审核"),l.value=!1,ee(),await se()}catch(p){console.error("申请提交失败:",p),c.error((p==null?void 0:p.message)||"申请提交失败")}finally{B.value=!1}}})}},je=async e=>{try{const d=(await rl(e.id)).data||{},p=[`申请ID：${d.id||e.id||"-"}`,`认证项目：${d.projectName||e.standardName||"-"}`,`岗位类型：${X[d.certificationType]||e.jobTypeLabel||"-"}`,`认证等级：${Y[d.level]||e.levelLabel||"-"}`,`当前状态：${me(d.status??e.status)}`,`认证图片：${d.practicalFileUrl||e.practicalFileUrl?"已上传":"未上传"}`,`申请时间：${d.applyTime||e.createTime||"-"}`,`审核时间：${d.reviewTime||e.updateTime||"-"}`].join(`
`);ge.alert(p,"申请详情",{confirmButtonText:"确定"})}catch(r){console.error("获取申请详情失败:",r),c.error("获取申请详情失败，请稍后重试")}},Ue=async e=>{if(!(e!=null&&e.id)){c.warning("证书信息不完整，无法下载");return}try{const d=(await sl(e.id)).data;if(!d){c.error("未获取到证书下载地址");return}const p=/^https?:\/\//i.test(d)?d:`${window.location.origin}${d.startsWith("/")?"":"/"}${d}`;window.open(p,"_blank")}catch(r){console.error("下载证书失败:",r),c.error("下载证书失败，请稍后重试")}},De=e=>{_.value=e,te.value=!0,E.value=[],D.value=null,J.value=0,w.value="",h.value=""},Ne=()=>{E.value=[],D.value=null,J.value=0,w.value="",h.value="",_.value=null},Ie=(e,r)=>{const d=["image/jpeg","image/png","image/webp"],p=[".jpg",".jpeg",".png",".webp"],s=e.name.substring(e.name.lastIndexOf(".")).toLowerCase();if(!d.includes(e.raw.type)&&!p.includes(s))return c.error("仅支持 JPG/JPEG/PNG/WEBP 图片"),!1;const b=10*1024*1024;return e.raw.size>b?(c.error("图片大小不能超过 10MB"),!1):(D.value=e.raw,E.value=[e],h.value="",!0)},Se=()=>{c.warning("只能上传一张图片，请先删除已选择的图片")},Me=e=>{if(e===0)return"0 B";const r=1024,d=["B","KB","MB","GB"],p=Math.floor(Math.log(e)/Math.log(r));return Math.round(e/Math.pow(r,p)*100)/100+" "+d[p]},Pe=async()=>{var e,r,d,p,s;if(!D.value||!_.value){c.warning("请先选择要上传的图片");return}q.value=!0,J.value=0,w.value="";try{const b=await _e(D.value,_.value.id,x=>{J.value=x});h.value=((e=b==null?void 0:b.data)==null?void 0:e.url)||((d=(r=b==null?void 0:b.data)==null?void 0:r.data)==null?void 0:d.url)||"",w.value="success",c.success("认证图片上传成功，等待管理员审核"),await se()}catch(b){w.value="exception",c.error(((s=(p=b.response)==null?void 0:p.data)==null?void 0:s.message)||"上传图片失败，请稍后重试")}finally{q.value=!1}},Be=()=>{h.value&&window.open(h.value,"_blank")},Ae=async e=>{if(!(e!=null&&e.certificateNo)){c.warning("证书编号缺失，无法验证");return}try{const d=(await dl(e.certificateNo)).data||{};d.valid?c.success(d.message||"证书验证通过"):c.warning(d.message||"证书验证未通过")}catch(r){console.error("验证证书失败:",r),c.error("验证证书失败，请稍后重试")}},Ee=async e=>{try{const d=(await nl(e.id)).data;if(!d){c.error("未获取到分享链接");return}Re(e,d)}catch{c.error("获取分享链接失败")}},Re=(e,r)=>{m.value=!0,A.value=e,Q.value=r},ze=async()=>{try{await navigator.clipboard.writeText(Q.value),c.success("链接已复制到剪贴板")}catch{c.error("复制失败，请手动复制")}},Ge=e=>{const r=A.value;if(!r)return;const d=`我获得了${r.name}认证！证书编号：${r.certificateNo}`,p=Q.value;let s="";switch(e){case"weibo":s=`https://service.weibo.com/share/share.php?url=${encodeURIComponent(p)}&title=${encodeURIComponent(d)}`;break;case"wechat":c.info("请使用微信扫描二维码分享");return;case"linkedin":s=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(p)}`;break;case"twitter":s=`https://twitter.com/intent/tweet?text=${encodeURIComponent(d)}&url=${encodeURIComponent(p)}`;break}s&&window.open(s,"_blank","width=600,height=400")},We=e=>{const r=[`标准ID：${e.id||"-"}`,`认证项目：${e.name||"-"}`,`岗位类型：${e.jobTypeLabel||e.jobType||"-"}`,`认证等级：${e.levelLabel||e.level||"-"}`,`说明：${e.description||"-"}`].join(`
`);ge.alert(r,"认证标准详情",{confirmButtonText:"确定"})},de=async()=>{W.value=!0;try{const e=await ol({userId:Number(pe("/personal")||0),daysBeforeExpire:30});e.data&&e.data.length>0?(U.value=e.data.map(r=>{const d=X[r.certificationType]||r.certificationType,p=Y[r.level]||r.level;return{...r,name:r.name||`${d}${p?`（${p}）`:""}`,certificateNo:r.certificateNumber,jobTypeLabel:d,levelLabel:p,remainingDays:Math.ceil((new Date(r.expireDate)-new Date)/(1e3*60*60*24))}}),G.value=!0):c.success("所有证书状态正常")}catch{c.error("检查证书有效期失败")}finally{W.value=!1}},Je=async e=>{try{await il({certificateId:e.id,years:1}),c.success("证书续期申请已提交"),G.value=!1,await de()}catch{c.error("续期失败")}},qe=()=>{f.value="certificate",G.value=!1};return el(()=>{se(),de()}),ye(()=>[C.jobType,C.level],()=>{C.standardId=""}),ye(()=>f.value,async e=>{if(e==="standard")try{await re()}catch{c.error("刷新认证标准失败")}}),{activeTab:f,applyDialogVisible:l,applyFormRef:M,applyUploadRef:t,applyImageList:P,applying:B,applyForm:C,applyRules:H,filteredStandards:he,formatStandardOptionLabel:Ce,handleApplyDialogClose:ne,handleApplyImageChange:N,handleApplyImageExceed:n,applications:Z,certificates:$,standards:T,getStatusText:me,getStatusTagType:Ve,applyCertification:Le,submitApplication:Fe,viewApplication:je,canUploadMaterial:Te,previewApplicationMaterial:xe,uploadPractical:De,downloadCertificate:Ue,verifyCertificate:Ae,shareCertificate:Ee,viewStandard:We,expiryReminderVisible:G,expiringCertificates:U,checkingExpiry:W,checkExpiringCertificates:de,renewCertificate:Je,goToRenewalPage:qe,shareDialogVisible:m,currentShareCert:A,currentShareLink:Q,copyShareLink:ze,shareToSocial:Ge,uploadDialogVisible:te,currentUploadApp:_,uploadRef:ae,fileList:E,selectedFile:D,uploadProgress:J,uploadStatus:w,uploading:q,uploadedFileUrl:h,uploadForm:oe,handleUploadDialogClose:Ne,handleFileChange:Ie,handleExceed:Se,formatFileSize:Me,confirmUpload:Pe,previewUploadedFile:Be}}},pl={class:"certification-container"},ul={class:"expiry-reminder-content"},fl={class:"expiring-cert-list"},ml={class:"cert-info-row"},vl={class:"cert-details"},yl={class:"cert-name"},gl={class:"cert-number"},bl={class:"cert-expiry"},_l={class:"expiry-date"},wl={class:"card-header"},hl={class:"header-actions"},Cl={class:"certification-tabs"},kl={key:1},Tl={class:"certificate-list"},xl={class:"certificate-header"},Vl={class:"certificate-content"},Ll={class:"cert-info"},Fl={class:"value"},jl={class:"cert-info"},Ul={class:"value"},Dl={class:"cert-info"},Nl={class:"value"},Il={class:"cert-info"},Sl={class:"value"},Ml={class:"cert-info"},Pl={class:"value"},Bl={class:"cert-info"},Al={class:"value"},El={class:"certificate-actions"},Rl={class:"dialog-footer"},zl={key:0,class:"share-dialog-content"},Gl={class:"share-cert-preview"},Wl={class:"cert-preview-header"},Jl={class:"cert-preview-info"},ql={class:"share-link-section"},Ol={class:"share-link-input"},Kl={class:"share-social-section"},Ql={class:"social-buttons"},Hl={key:0,class:"upload-dialog-content"},Xl={class:"upload-info"},Yl={class:"file-info"},Zl={key:0,class:"upload-success"},$l={class:"uploaded-file-preview"},et={class:"dialog-footer"};function lt(f,l,M,t,P,z){const B=y("el-alert"),G=y("Medal"),U=y("el-icon"),W=y("el-tag"),m=y("el-button"),A=y("el-dialog"),Q=y("Bell"),te=y("el-badge"),_=y("el-table-column"),ae=y("el-table"),E=y("el-tab-pane"),D=y("el-card"),J=y("el-tabs"),w=y("el-option"),q=y("el-select"),h=y("el-form-item"),oe=y("el-input"),Z=y("upload-filled"),$=y("el-upload"),T=y("el-form"),C=y("CopyDocument"),H=y("el-descriptions-item"),ie=y("el-descriptions"),ee=y("el-progress"),ne=y("el-result");return k(),S("div",pl,[a(A,{modelValue:t.expiryReminderVisible,"onUpdate:modelValue":l[1]||(l[1]=n=>t.expiryReminderVisible=n),title:"证书有效期提醒",width:"500px"},{footer:o(()=>[a(m,{onClick:l[0]||(l[0]=n=>t.expiryReminderVisible=!1)},{default:o(()=>[...l[20]||(l[20]=[u("稍后处理",-1)])]),_:1}),a(m,{type:"primary",onClick:t.goToRenewalPage},{default:o(()=>[...l[21]||(l[21]=[u("查看全部证书",-1)])]),_:1},8,["onClick"])]),default:o(()=>[i("div",ul,[t.expiringCertificates.length>0?(k(),O(B,{key:0,title:"您有证书即将过期",type:"warning",closable:!1,"show-icon":""},{default:o(()=>[...l[18]||(l[18]=[i("p",null,"以下证书将在30天内过期，请及时续期：",-1)])]),_:1})):K("",!0),i("div",fl,[(k(!0),S(ue,null,fe(t.expiringCertificates,n=>(k(),S("div",{key:n.id,class:"expiring-cert-item"},[i("div",ml,[a(U,{class:"cert-icon"},{default:o(()=>[a(G)]),_:1}),i("div",vl,[i("span",yl,g(n.name),1),i("span",gl,g(n.certificateNo),1)])]),i("div",bl,[a(W,{type:n.remainingDays<=7?"danger":"warning",size:"small"},{default:o(()=>[u(" 剩余 "+g(n.remainingDays)+" 天 ",1)]),_:2},1032,["type"]),i("span",_l,"到期："+g(n.expireDate),1)]),a(m,{type:"primary",size:"small",onClick:N=>t.renewCertificate(n)},{default:o(()=>[...l[19]||(l[19]=[u("立即续期",-1)])]),_:1},8,["onClick"])]))),128))])])]),_:1},8,["modelValue"]),a(D,{shadow:"hover"},{header:o(()=>[i("div",wl,[l[24]||(l[24]=i("h2",null,"技能认证管理",-1)),i("div",hl,[a(te,{value:t.expiringCertificates.length,hidden:t.expiringCertificates.length===0,class:"expiry-badge"},{default:o(()=>[a(m,{onClick:t.checkExpiringCertificates,loading:t.checkingExpiry},{default:o(()=>[a(U,null,{default:o(()=>[a(Q)]),_:1}),l[22]||(l[22]=u(" 有效期检查 ",-1))]),_:1},8,["onClick","loading"])]),_:1},8,["value","hidden"]),a(m,{type:"primary",onClick:t.applyCertification},{default:o(()=>[...l[23]||(l[23]=[u("申请认证",-1)])]),_:1},8,["onClick"])])])]),default:o(()=>[i("div",Cl,[a(J,{modelValue:t.activeTab,"onUpdate:modelValue":l[2]||(l[2]=n=>t.activeTab=n),type:"card"},{default:o(()=>[a(E,{label:"认证申请",name:"application"},{default:o(()=>[a(ae,{data:t.applications,style:{width:"100%"}},{default:o(()=>[a(_,{prop:"id",label:"申请ID",width:"100"}),a(_,{prop:"standardName",label:"认证项目",width:"200"}),a(_,{prop:"jobTypeLabel",label:"岗位类型",width:"120"}),a(_,{prop:"levelLabel",label:"等级",width:"100"}),a(_,{prop:"status",label:"状态",width:"120"},{default:o(n=>[a(W,{type:t.getStatusTagType(n.row.status)},{default:o(()=>[u(g(t.getStatusText(n.row.status)),1)]),_:2},1032,["type"])]),_:1}),a(_,{label:"认证材料",width:"120"},{default:o(n=>[n.row.practicalFileUrl?(k(),O(m,{key:0,type:"primary",link:"",onClick:N=>t.previewApplicationMaterial(n.row)},{default:o(()=>[...l[25]||(l[25]=[u(" 查看图片 ",-1)])]),_:1},8,["onClick"])):(k(),S("span",kl,"未上传"))]),_:1}),a(_,{prop:"createTime",label:"申请时间",width:"180"}),a(_,{prop:"updateTime",label:"更新时间",width:"180"}),a(_,{label:"操作",width:"200",fixed:"right"},{default:o(n=>[a(m,{type:"primary",size:"small",onClick:N=>t.viewApplication(n.row)},{default:o(()=>[...l[26]||(l[26]=[u("查看详情",-1)])]),_:1},8,["onClick"]),t.canUploadMaterial(n.row)?(k(),O(m,{key:0,type:"warning",size:"small",onClick:N=>t.uploadPractical(n.row)},{default:o(()=>[u(g(n.row.practicalFileUrl?"更新图片":"上传图片"),1)]),_:2},1032,["onClick"])):K("",!0)]),_:1})]),_:1},8,["data"])]),_:1}),a(E,{label:"我的证书",name:"certificate"},{default:o(()=>[i("div",Tl,[(k(!0),S(ue,null,fe(t.certificates,n=>(k(),O(D,{key:n.id,shadow:"hover",class:"certificate-item"},{default:o(()=>[i("div",xl,[i("h3",null,g(n.name),1),a(W,{type:n.status===1?"success":"warning"},{default:o(()=>[u(g(n.status===1?"有效":"已过期"),1)]),_:2},1032,["type"])]),i("div",Vl,[i("div",Ll,[l[27]||(l[27]=i("span",{class:"label"},"证书编号：",-1)),i("span",Fl,g(n.certificateNo),1)]),i("div",jl,[l[28]||(l[28]=i("span",{class:"label"},"认证项目：",-1)),i("span",Ul,g(n.standardName),1)]),i("div",Dl,[l[29]||(l[29]=i("span",{class:"label"},"岗位类型：",-1)),i("span",Nl,g(n.jobType),1)]),i("div",Il,[l[30]||(l[30]=i("span",{class:"label"},"等级：",-1)),i("span",Sl,g(n.level),1)]),i("div",Ml,[l[31]||(l[31]=i("span",{class:"label"},"颁发日期：",-1)),i("span",Pl,g(n.issueDate),1)]),i("div",Bl,[l[32]||(l[32]=i("span",{class:"label"},"有效期至：",-1)),i("span",Al,g(n.expireDate),1)])]),i("div",El,[a(m,{type:"primary",size:"small",onClick:N=>t.downloadCertificate(n)},{default:o(()=>[...l[33]||(l[33]=[u("下载证书",-1)])]),_:1},8,["onClick"]),a(m,{type:"success",size:"small",onClick:N=>t.verifyCertificate(n)},{default:o(()=>[...l[34]||(l[34]=[u("验证证书",-1)])]),_:1},8,["onClick"]),a(m,{size:"small",onClick:N=>t.shareCertificate(n)},{default:o(()=>[...l[35]||(l[35]=[u("分享证书",-1)])]),_:1},8,["onClick"])])]),_:2},1024))),128))])]),_:1}),a(E,{label:"认证标准",name:"standard"},{default:o(()=>[a(ae,{data:t.standards,style:{width:"100%"}},{default:o(()=>[a(_,{prop:"id",label:"标准ID",width:"100"}),a(_,{prop:"name",label:"认证项目",width:"200"}),a(_,{prop:"jobTypeLabel",label:"岗位类型",width:"120"}),a(_,{prop:"levelLabel",label:"等级",width:"100"}),a(_,{prop:"description",label:"描述"}),a(_,{label:"操作",width:"150",fixed:"right"},{default:o(n=>[a(m,{type:"primary",size:"small",onClick:N=>t.viewStandard(n.row)},{default:o(()=>[...l[36]||(l[36]=[u("查看详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue"])])]),_:1}),a(A,{modelValue:t.applyDialogVisible,"onUpdate:modelValue":l[8]||(l[8]=n=>t.applyDialogVisible=n),title:"申请技能认证",width:"600px",onClose:t.handleApplyDialogClose},{footer:o(()=>[i("div",Rl,[a(m,{onClick:l[7]||(l[7]=n=>t.applyDialogVisible=!1),disabled:t.applying},{default:o(()=>[...l[40]||(l[40]=[u("取消",-1)])]),_:1},8,["disabled"]),a(m,{type:"primary",onClick:t.submitApplication,loading:t.applying},{default:o(()=>[...l[41]||(l[41]=[u("提交申请并上传图片",-1)])]),_:1},8,["onClick","loading"])])]),default:o(()=>[a(T,{ref:"applyFormRef",model:t.applyForm,rules:t.applyRules,"label-width":"120px"},{default:o(()=>[a(h,{label:"岗位类型",prop:"jobType"},{default:o(()=>[a(q,{modelValue:t.applyForm.jobType,"onUpdate:modelValue":l[3]||(l[3]=n=>t.applyForm.jobType=n),placeholder:"请选择岗位类型"},{default:o(()=>[a(w,{label:"设计师",value:"designer"}),a(w,{label:"打版师",value:"patternmaker"}),a(w,{label:"质检员",value:"inspector"}),a(w,{label:"导购",value:"sales"})]),_:1},8,["modelValue"])]),_:1}),a(h,{label:"认证等级",prop:"level"},{default:o(()=>[a(q,{modelValue:t.applyForm.level,"onUpdate:modelValue":l[4]||(l[4]=n=>t.applyForm.level=n),placeholder:"请选择认证等级"},{default:o(()=>[a(w,{label:"初级",value:1}),a(w,{label:"中级",value:2}),a(w,{label:"高级",value:3}),a(w,{label:"专家级",value:4})]),_:1},8,["modelValue"])]),_:1}),a(h,{label:"认证项目",prop:"standardId"},{default:o(()=>[a(q,{modelValue:t.applyForm.standardId,"onUpdate:modelValue":l[5]||(l[5]=n=>t.applyForm.standardId=n),placeholder:"请选择认证项目"},{default:o(()=>[(k(!0),S(ue,null,fe(t.filteredStandards,n=>(k(),O(w,{key:n.id,label:t.formatStandardOptionLabel(n),value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(h,{label:"申请说明"},{default:o(()=>[a(oe,{modelValue:t.applyForm.description,"onUpdate:modelValue":l[6]||(l[6]=n=>t.applyForm.description=n),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),a(h,{label:"认证图片",required:""},{default:o(()=>[a($,{ref:"applyUploadRef",drag:"","auto-upload":!1,limit:1,"file-list":t.applyImageList,"on-change":t.handleApplyImageChange,"on-exceed":t.handleApplyImageExceed,accept:".jpg,.jpeg,.png,.webp","list-type":"picture"},{tip:o(()=>[...l[37]||(l[37]=[i("div",{class:"el-upload__tip"}," 仅支持 JPG/JPEG/PNG/WEBP，图片不超过 10MB ",-1)])]),default:o(()=>[a(U,{class:"el-icon--upload"},{default:o(()=>[a(Z)]),_:1}),l[38]||(l[38]=i("div",{class:"el-upload__text"},[u(" 将图片拖到此处，或"),i("em",null,"点击上传图片")],-1))]),_:1},8,["file-list","on-change","on-exceed"]),l[39]||(l[39]=i("div",{class:"el-upload__tip",style:{"margin-top":"8px"}}," 选择图片后，点击“提交申请并上传图片”完成提交。 ",-1))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","onClose"]),a(A,{modelValue:t.shareDialogVisible,"onUpdate:modelValue":l[15]||(l[15]=n=>t.shareDialogVisible=n),title:"分享证书",width:"500px"},{footer:o(()=>[a(m,{onClick:l[14]||(l[14]=n=>t.shareDialogVisible=!1)},{default:o(()=>[...l[50]||(l[50]=[u("关闭",-1)])]),_:1})]),default:o(()=>[t.currentShareCert?(k(),S("div",zl,[i("div",Gl,[i("div",Wl,[a(U,{class:"cert-medal"},{default:o(()=>[a(G)]),_:1}),i("div",Jl,[i("h3",null,g(t.currentShareCert.name),1),i("p",null,"证书编号："+g(t.currentShareCert.certificateNo),1)])])]),i("div",ql,[l[43]||(l[43]=i("h4",null,"分享链接",-1)),i("div",Ol,[a(oe,{modelValue:t.currentShareLink,"onUpdate:modelValue":l[9]||(l[9]=n=>t.currentShareLink=n),readonly:""},{append:o(()=>[a(m,{onClick:t.copyShareLink},{default:o(()=>[a(U,null,{default:o(()=>[a(C)]),_:1}),l[42]||(l[42]=u(" 复制 ",-1))]),_:1},8,["onClick"])]),_:1},8,["modelValue"])])]),i("div",Kl,[l[48]||(l[48]=i("h4",null,"分享到社交平台",-1)),i("div",Ql,[a(m,{class:"social-btn weibo",onClick:l[10]||(l[10]=n=>t.shareToSocial("weibo"))},{default:o(()=>[...l[44]||(l[44]=[i("span",{class:"social-icon"},"微博",-1)])]),_:1}),a(m,{class:"social-btn wechat",onClick:l[11]||(l[11]=n=>t.shareToSocial("wechat"))},{default:o(()=>[...l[45]||(l[45]=[i("span",{class:"social-icon"},"微信",-1)])]),_:1}),a(m,{class:"social-btn linkedin",onClick:l[12]||(l[12]=n=>t.shareToSocial("linkedin"))},{default:o(()=>[...l[46]||(l[46]=[i("span",{class:"social-icon"},"LinkedIn",-1)])]),_:1}),a(m,{class:"social-btn twitter",onClick:l[13]||(l[13]=n=>t.shareToSocial("twitter"))},{default:o(()=>[...l[47]||(l[47]=[i("span",{class:"social-icon"},"Twitter",-1)])]),_:1})])]),a(B,{title:"温馨提示",type:"info",closable:!1,"show-icon":"",style:{"margin-top":"20px"}},{default:o(()=>[...l[49]||(l[49]=[u(" 分享链接可供他人验证您的证书真伪，有效期为30天。 ",-1)])]),_:1})])):K("",!0)]),_:1},8,["modelValue"]),a(A,{modelValue:t.uploadDialogVisible,"onUpdate:modelValue":l[17]||(l[17]=n=>t.uploadDialogVisible=n),title:"上传认证图片",width:"600px",onClose:t.handleUploadDialogClose},{footer:o(()=>[i("div",et,[a(m,{onClick:l[16]||(l[16]=n=>t.uploadDialogVisible=!1),disabled:t.uploading},{default:o(()=>[...l[58]||(l[58]=[u("取消",-1)])]),_:1},8,["disabled"]),a(m,{type:"primary",onClick:t.confirmUpload,loading:t.uploading,disabled:!t.selectedFile},{default:o(()=>[u(g(t.uploading?"上传中...":"确认上传"),1)]),_:1},8,["onClick","loading","disabled"])])]),default:o(()=>[t.currentUploadApp?(k(),S("div",Hl,[i("div",Xl,[a(ie,{column:2,border:""},{default:o(()=>[a(H,{label:"认证项目"},{default:o(()=>[u(g(t.currentUploadApp.standardName),1)]),_:1}),a(H,{label:"岗位类型"},{default:o(()=>[u(g(t.currentUploadApp.jobTypeLabel),1)]),_:1}),a(H,{label:"认证等级"},{default:o(()=>[u(g(t.currentUploadApp.levelLabel),1)]),_:1}),a(H,{label:"申请时间"},{default:o(()=>[u(g(t.currentUploadApp.createTime),1)]),_:1})]),_:1})]),a(B,{title:"上传要求",type:"info",closable:!1,"show-icon":"",style:{margin:"20px 0"}},{default:o(()=>[...l[51]||(l[51]=[i("ul",{class:"upload-requirements"},[i("li",null,"支持格式：JPG、JPEG、PNG、WEBP"),i("li",null,"文件大小：不超过 10MB"),i("li",null,"内容要求：上传能证明技能能力的图片材料")],-1)])]),_:1}),a(T,{model:t.uploadForm,"label-width":"100px"},{default:o(()=>[a(h,{label:"选择文件"},{default:o(()=>[a($,{ref:"uploadRef",class:"upload-demo",drag:"","auto-upload":!1,limit:1,"on-change":t.handleFileChange,"on-exceed":t.handleExceed,"file-list":t.fileList,accept:".jpg,.jpeg,.png,.webp"},{tip:o(()=>[...l[52]||(l[52]=[i("div",{class:"el-upload__tip"}," 支持 JPG/JPEG/PNG/WEBP，图片不超过 10MB ",-1)])]),default:o(()=>[a(U,{class:"el-icon--upload"},{default:o(()=>[a(Z)]),_:1}),l[53]||(l[53]=i("div",{class:"el-upload__text"},[u(" 将图片拖到此处，或"),i("em",null,"点击选择图片")],-1))]),_:1},8,["on-change","on-exceed","file-list"])]),_:1}),t.selectedFile?(k(),O(h,{key:0,label:"文件信息"},{default:o(()=>[i("div",Yl,[i("p",null,[l[54]||(l[54]=i("strong",null,"文件名：",-1)),u(g(t.selectedFile.name),1)]),i("p",null,[l[55]||(l[55]=i("strong",null,"文件大小：",-1)),u(g(t.formatFileSize(t.selectedFile.size)),1)]),i("p",null,[l[56]||(l[56]=i("strong",null,"文件类型：",-1)),u(g(t.selectedFile.type||"未知"),1)])])]),_:1})):K("",!0),t.uploadProgress>0&&t.uploadProgress<100?(k(),O(h,{key:1,label:"上传进度"},{default:o(()=>[a(ee,{percentage:t.uploadProgress,status:t.uploadStatus},null,8,["percentage","status"])]),_:1})):K("",!0)]),_:1},8,["model"]),t.uploadedFileUrl?(k(),S("div",Zl,[a(ne,{icon:"success",title:"上传成功","sub-title":"认证图片已成功上传，请等待管理员审核"},{extra:o(()=>[i("div",$l,[i("p",null,"文件URL："+g(t.uploadedFileUrl),1),a(m,{type:"primary",onClick:t.previewUploadedFile},{default:o(()=>[...l[57]||(l[57]=[u("预览图片",-1)])]),_:1},8,["onClick"])])]),_:1})])):K("",!0)])):K("",!0)]),_:1},8,["modelValue","onClose"])])}const nt=Oe(cl,[["render",lt],["__scopeId","data-v-6132ec25"]]);export{nt as default};
