import{r as j}from"./request-32baecc7.js";import{_ as B,r as Y,z as F,o as L,e as p,D as q,G as z,f as i,g as d,i as a,w as t,E as v,h as s,n as g,t as M,H as N,x as n,F as y,j as k}from"./index-a65af770.js";const T={name:"ResumeManage",setup(){const w=Y(!1),o=Y(null),f=Y(!1),e=F({basicInfo:{name:"",phone:"",email:"",location:"",careerObjective:""},education:[],workExperience:[],projectExperience:[],skills:[],certificates:[],isPublic:!1}),P={"basicInfo.name":[{required:!0,message:"请输入姓名",trigger:"blur"}],"basicInfo.phone":[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],"basicInfo.email":[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]},E=async()=>{var u;f.value=!0;try{const c=await j.get("/resume/current");c.data&&(Object.assign(e.basicInfo,c.data.basicInfo||{}),e.education=c.data.education||[],e.workExperience=c.data.workExperience||[],e.projectExperience=c.data.projectExperience||[],e.skills=c.data.skills||[],e.certificates=c.data.certificates||[],e.isPublic=c.data.isPublic||!1)}catch(c){console.error("加载简历失败:",c),((u=c.response)==null?void 0:u.status)!==404&&v.error("加载简历失败，请刷新重试")}finally{f.value=!1}},h=()=>{w.value=!0},C=async()=>{if(!o.value){v.error("表单未加载");return}o.value.validate(async u=>{if(!u)return v.error("请填写必填项"),!1;f.value=!0;try{await j.put("/resume",{basicInfo:e.basicInfo,education:e.education,workExperience:e.workExperience,projectExperience:e.projectExperience,skills:e.skills,certificates:e.certificates,isPublic:e.isPublic}),w.value=!1,v.success("简历保存成功")}catch(c){console.error("保存简历失败:",c),v.error(c.message||"保存简历失败，请重试")}finally{f.value=!1}})},x=()=>{w.value=!1,E()},D=async()=>{f.value=!0;try{const u=await j.get("/resume/export",{responseType:"blob"}),c=new Blob([u],{type:"application/pdf"}),I=window.URL.createObjectURL(c),V=document.createElement("a");V.href=I,V.download=`简历_${e.basicInfo.name||"未命名"}_${new Date().getTime()}.pdf`,document.body.appendChild(V),V.click(),document.body.removeChild(V),window.URL.revokeObjectURL(I),v.success("简历导出成功")}catch(u){console.error("导出简历失败:",u),v.error("导出简历失败，请重试")}finally{f.value=!1}},b=async()=>{f.value=!0;try{await j.put("/resume/public",{isPublic:e.isPublic}),v.success(e.isPublic?"简历已设为公开":"简历已设为私有")}catch(u){console.error("设置简历公开状态失败:",u),e.isPublic=!e.isPublic,v.error("设置失败，请重试")}finally{f.value=!1}};return L(()=>{E()}),{isEditing:w,loading:f,resume:e,resumeForm:o,resumeRules:P,loadResume:E,editResume:h,saveResume:C,cancelEdit:x,exportResume:D,togglePublic:b,addEducation:()=>{e.education.push({school:"",major:"",degree:"",startDate:"",endDate:"",description:""})},removeEducation:u=>{e.education.length>1?e.education.splice(u,1):v.warning("至少保留一条教育经历")}}}},G={class:"resume-container"},H={class:"card-header"},S={key:1,class:"resume-preview"},A={class:"resume-header"},J={class:"contact-info"},K={class:"career-objective"},Q={class:"resume-section"},W={class:"edu-header"},X={class:"school"},Z={class:"period"},$={class:"edu-details"},ee={class:"major"},se={class:"degree"},le={class:"edu-desc"},oe={class:"resume-section"},ae={class:"work-header"},te={class:"company"},ne={class:"period"},ie={class:"work-details"},re={class:"position"},ce={class:"work-responsibilities"},de={class:"resume-section"},ue={class:"project-header"},me={class:"project-name"},_e={class:"period"},pe={class:"project-details"},fe={class:"role"},be={class:"project-desc"},ve={class:"project-achievements"},he={class:"resume-section"},ge={class:"skills-certificates"},ye={class:"skills"},ke={class:"skill-tags"},Ve={class:"certificates"},we={class:"cert-name"},Ie={class:"cert-date"},Ee={class:"resume-actions"},Ue={key:2,class:"resume-edit"},je={class:"section-header"},Ce={class:"group-header"},xe={class:"date-range"},De={class:"form-actions"};function Re(w,o,f,e,P,E){const h=p("el-button"),C=p("el-empty"),x=p("el-tag"),D=p("el-switch"),b=p("el-input"),_=p("el-form-item"),U=p("el-card"),u=p("el-option"),c=p("el-select"),I=p("el-date-picker"),V=p("el-form"),O=q("loading");return z((i(),d("div",G,[a(U,{shadow:"hover"},{header:t(()=>[s("div",H,[o[7]||(o[7]=s("h2",null,"简历管理",-1)),a(h,{type:"primary",onClick:e.editResume,disabled:e.loading},{default:t(()=>[...o[6]||(o[6]=[g("编辑简历",-1)])]),_:1},8,["onClick","disabled"])])]),default:t(()=>[!e.loading&&!e.resume.basicInfo.name&&!e.isEditing?(i(),M(C,{key:0,description:"还没有简历，点击上方编辑简历按钮创建您的简历"},{default:t(()=>[a(h,{type:"primary",onClick:e.editResume},{default:t(()=>[...o[8]||(o[8]=[g("立即创建",-1)])]),_:1},8,["onClick"])]),_:1})):N("",!0),!e.isEditing&&e.resume.basicInfo.name?(i(),d("div",S,[s("div",A,[s("h1",null,n(e.resume.basicInfo.name),1),s("p",J,n(e.resume.basicInfo.phone)+" | "+n(e.resume.basicInfo.email)+" | "+n(e.resume.basicInfo.location),1),s("p",K,n(e.resume.basicInfo.careerObjective),1)]),s("div",Q,[o[9]||(o[9]=s("h3",null,"教育背景",-1)),(i(!0),d(y,null,k(e.resume.education,(l,r)=>(i(),d("div",{key:r,class:"edu-item"},[s("div",W,[s("span",X,n(l.school),1),s("span",Z,n(l.startDate)+" - "+n(l.endDate),1)]),s("div",$,[s("span",ee,n(l.major),1),s("span",se,n(l.degree),1)]),s("p",le,n(l.description),1)]))),128))]),s("div",oe,[o[10]||(o[10]=s("h3",null,"工作经历",-1)),(i(!0),d(y,null,k(e.resume.workExperience,(l,r)=>(i(),d("div",{key:r,class:"work-item"},[s("div",ae,[s("span",te,n(l.company),1),s("span",ne,n(l.startDate)+" - "+n(l.endDate),1)]),s("div",ie,[s("span",re,n(l.position),1)]),s("ul",ce,[(i(!0),d(y,null,k(l.responsibilities,(m,R)=>(i(),d("li",{key:R},n(m),1))),128))])]))),128))]),s("div",de,[o[11]||(o[11]=s("h3",null,"项目经验",-1)),(i(!0),d(y,null,k(e.resume.projectExperience,(l,r)=>(i(),d("div",{key:r,class:"project-item"},[s("div",ue,[s("span",me,n(l.name),1),s("span",_e,n(l.startDate)+" - "+n(l.endDate),1)]),s("div",pe,[s("span",fe,n(l.role),1)]),s("p",be,n(l.description),1),s("ul",ve,[(i(!0),d(y,null,k(l.achievements,(m,R)=>(i(),d("li",{key:R},n(m),1))),128))])]))),128))]),s("div",he,[o[14]||(o[14]=s("h3",null,"技能证书",-1)),s("div",ge,[s("div",ye,[o[12]||(o[12]=s("h4",null,"专业技能",-1)),s("div",ke,[(i(!0),d(y,null,k(e.resume.skills,(l,r)=>(i(),M(x,{key:r,size:"small",type:"info"},{default:t(()=>[g(n(l),1)]),_:2},1024))),128))])]),s("div",Ve,[o[13]||(o[13]=s("h4",null,"认证证书",-1)),(i(!0),d(y,null,k(e.resume.certificates,(l,r)=>(i(),d("div",{key:r,class:"cert-item"},[s("span",we,n(l.name),1),s("span",Ie,n(l.date),1)]))),128))])])]),s("div",Ee,[a(h,{type:"success",onClick:e.exportResume},{default:t(()=>[...o[15]||(o[15]=[g("导出PDF",-1)])]),_:1},8,["onClick"]),a(D,{modelValue:e.resume.isPublic,"onUpdate:modelValue":o[0]||(o[0]=l=>e.resume.isPublic=l),"active-text":"公开","inactive-text":"私有",onChange:e.togglePublic},null,8,["modelValue","onChange"])])])):(i(),d("div",Ue,[a(V,{ref:"resumeForm",model:e.resume,"label-width":"100px",rules:e.resumeRules},{default:t(()=>[a(U,{shadow:"hover",class:"edit-section"},{header:t(()=>[...o[16]||(o[16]=[s("h3",null,"基本信息",-1)])]),default:t(()=>[a(_,{label:"姓名",prop:"basicInfo.name"},{default:t(()=>[a(b,{modelValue:e.resume.basicInfo.name,"onUpdate:modelValue":o[1]||(o[1]=l=>e.resume.basicInfo.name=l)},null,8,["modelValue"])]),_:1}),a(_,{label:"手机号",prop:"basicInfo.phone"},{default:t(()=>[a(b,{modelValue:e.resume.basicInfo.phone,"onUpdate:modelValue":o[2]||(o[2]=l=>e.resume.basicInfo.phone=l)},null,8,["modelValue"])]),_:1}),a(_,{label:"邮箱",prop:"basicInfo.email"},{default:t(()=>[a(b,{modelValue:e.resume.basicInfo.email,"onUpdate:modelValue":o[3]||(o[3]=l=>e.resume.basicInfo.email=l)},null,8,["modelValue"])]),_:1}),a(_,{label:"所在地"},{default:t(()=>[a(b,{modelValue:e.resume.basicInfo.location,"onUpdate:modelValue":o[4]||(o[4]=l=>e.resume.basicInfo.location=l)},null,8,["modelValue"])]),_:1}),a(_,{label:"职业目标"},{default:t(()=>[a(b,{modelValue:e.resume.basicInfo.careerObjective,"onUpdate:modelValue":o[5]||(o[5]=l=>e.resume.basicInfo.careerObjective=l),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1}),a(U,{shadow:"hover",class:"edit-section"},{header:t(()=>[s("div",je,[o[18]||(o[18]=s("h3",null,"教育背景",-1)),a(h,{type:"primary",size:"small",onClick:e.addEducation},{default:t(()=>[...o[17]||(o[17]=[g("添加教育经历",-1)])]),_:1},8,["onClick"])])]),default:t(()=>[(i(!0),d(y,null,k(e.resume.education,(l,r)=>(i(),d("div",{key:r,class:"form-item-group"},[s("div",Ce,[s("span",null,"教育经历 "+n(r+1),1),a(h,{type:"danger",size:"small",onClick:m=>e.removeEducation(r)},{default:t(()=>[...o[19]||(o[19]=[g("删除",-1)])]),_:1},8,["onClick"])]),a(_,{label:"学校 "+(r+1)},{default:t(()=>[a(b,{modelValue:l.school,"onUpdate:modelValue":m=>l.school=m},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),a(_,{label:"专业 "+(r+1)},{default:t(()=>[a(b,{modelValue:l.major,"onUpdate:modelValue":m=>l.major=m},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),a(_,{label:"学历 "+(r+1)},{default:t(()=>[a(c,{modelValue:l.degree,"onUpdate:modelValue":m=>l.degree=m,placeholder:"请选择学历"},{default:t(()=>[a(u,{label:"专科",value:"专科"}),a(u,{label:"本科",value:"本科"}),a(u,{label:"硕士",value:"硕士"}),a(u,{label:"博士",value:"博士"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),s("div",xe,[a(_,{label:"开始时间 "+(r+1)},{default:t(()=>[a(I,{modelValue:l.startDate,"onUpdate:modelValue":m=>l.startDate=m,type:"date",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),a(_,{label:"结束时间 "+(r+1)},{default:t(()=>[a(I,{modelValue:l.endDate,"onUpdate:modelValue":m=>l.endDate=m,type:"date",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),a(_,{label:"描述 "+(r+1)},{default:t(()=>[a(b,{modelValue:l.description,"onUpdate:modelValue":m=>l.description=m,type:"textarea",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]))),128))]),_:1}),s("div",De,[a(h,{type:"primary",onClick:e.saveResume},{default:t(()=>[...o[20]||(o[20]=[g("保存简历",-1)])]),_:1},8,["onClick"]),a(h,{onClick:e.cancelEdit},{default:t(()=>[...o[21]||(o[21]=[g("取消",-1)])]),_:1},8,["onClick"])])]),_:1},8,["model","rules"])]))]),_:1})])),[[O,e.loading]])}const Me=B(T,[["render",Re],["__scopeId","data-v-f62350a5"]]);export{Me as default};
