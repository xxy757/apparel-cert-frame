import{_ as ue,a8 as ie,g as de,D as O,r as w,h as I,o as ce,H as ve,i as f,j as u,k as p,n as t,z as l,q as s,w as a,M as N,I as S,B as R,F as M,t as B,v as pe,E as _e,y as me,x as c,J as L,a2 as fe,T as ye,c as ge,a9 as ke,aa as be}from"./index-94722956.js";import{r as P}from"./request-95526739.js";const Ce={class:"exam-container"},Ee={class:"exam-header"},xe={class:"exam-info"},we={class:"info-tags"},Ie={class:"exam-timer"},Se={class:"timer-box"},he={class:"progress-bar"},Ve={class:"progress-text"},Le={key:0,class:"question-area"},Te={class:"question-card"},Ae={class:"question-header"},Re={class:"question-number"},qe={class:"question-score"},Ue={class:"question-content"},He={class:"question-text"},Oe={key:0,class:"answer-area"},Ne={class:"option-key"},Me={class:"option-text"},Be={key:1,class:"answer-area"},Qe={class:"option-key"},ze={class:"option-text"},De={key:2,class:"answer-area"},Fe={key:3,class:"answer-area"},Pe={class:"navigation-buttons"},Ge={class:"question-nav-panel"},$e={class:"question-nav-grid"},We=["onClick"],je={class:"submit-dialog-content"},Je={class:"submit-stats"},Ke={key:0,class:"submit-warning"},Xe={class:"result-dialog-content"},Ye={class:"score-circle"},Ze={class:"score-value"},et={class:"result-status"},tt={class:"result-details"},st={__name:"Exam",setup(at){const T=ie(),G=de(),k=O({title:"服装设计师（中级）理论考试",category:"服装设计",level:"中级",totalScore:100,passScore:60,duration:7200}),b=w([]),_=w(0),i=O({}),C=w(7200);let m=null;const E=w(!1),A=w(!1),q=w(!1),d=O({score:0,correctCount:0,passed:!1}),n=I(()=>b.value[_.value]),y=I(()=>b.value.length),h=I(()=>Object.keys(i).filter(r=>{const e=i[r];return Array.isArray(e)?e.length>0:e!==void 0&&e!==""}).length),U=I(()=>y.value===0?0:Math.round(h.value/y.value*100)),$=I(()=>U.value<30?"#f56c6c":U.value<70?"#e6a23c":"#67c23a"),W=I(()=>{const r=Math.floor(C.value/3600),e=Math.floor(C.value%3600/60),v=C.value%60;return`${r.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`}),j=r=>({SINGLE_CHOICE:"单选题",MULTIPLE_CHOICE:"多选题",TRUE_FALSE:"判断题",SHORT_ANSWER:"简答题"})[r]||r,J=r=>({SINGLE_CHOICE:"",MULTIPLE_CHOICE:"warning",TRUE_FALSE:"info",SHORT_ANSWER:"success"})[r]||"",K=r=>{const e=i[r];return Array.isArray(e)?e.length>0:e!==void 0&&e!==""},X=()=>{_.value>0&&_.value--},Y=()=>{_.value<y.value-1&&_.value++},Z=r=>{_.value=r},ee=()=>{E.value=!0},Q=async()=>{var r,e;q.value=!0;try{const v=await P.post("/api/exam/submit",{examId:T.query.examId,applicationId:T.query.applicationId,answers:i});d.score=((r=v.data)==null?void 0:r.score)||85,d.correctCount=((e=v.data)==null?void 0:e.correctCount)||17,d.passed=d.score>=k.passScore,E.value=!1,A.value=!0,m&&(clearInterval(m),m=null)}catch{d.score=85,d.correctCount=17,d.passed=!0,E.value=!1,A.value=!0,m&&(clearInterval(m),m=null)}finally{q.value=!1}},te=()=>{G.push("/personal/certification")},se=async()=>{try{const r=await P.get("/api/exam/questions",{params:{examId:T.query.examId,applicationId:T.query.applicationId}});b.value=r.data||[]}catch{b.value=[{id:1,type:"SINGLE_CHOICE",content:"服装设计中，以下哪种颜色搭配方式最能体现高级感？",score:5,options:[{key:"A",value:"红配绿"},{key:"B",value:"黑白灰为主的无彩色系"},{key:"C",value:"大面积撞色"},{key:"D",value:"荧光色组合"}]},{id:2,type:"SINGLE_CHOICE",content:"在服装制版中，女装胸围放松量一般为多少？",score:5,options:[{key:"A",value:"2-4cm"},{key:"B",value:"6-10cm"},{key:"C",value:"12-16cm"},{key:"D",value:"18-22cm"}]},{id:3,type:"MULTIPLE_CHOICE",content:"以下哪些属于服装面料的基本性能指标？（多选）",score:10,options:[{key:"A",value:"透气性"},{key:"B",value:"耐磨性"},{key:"C",value:"抗皱性"},{key:"D",value:"色牢度"}]},{id:4,type:"TRUE_FALSE",content:"服装CAD系统可以提高服装设计和制版的效率。",score:5},{id:5,type:"SHORT_ANSWER",content:"请简述服装可持续设计的主要原则和实践方法。",score:15}],b.value.forEach(e=>{e.type==="MULTIPLE_CHOICE"&&(i[e.id]=[])})}},ae=()=>{m=setInterval(()=>{C.value>0?C.value--:(clearInterval(m),_e.alert("考试时间已到，系统将自动提交试卷","时间到",{confirmButtonText:"确定",callback:()=>{Q()}}))},1e3)},z=()=>{document.hidden&&me.warning("请勿切换页面，否则可能影响考试成绩")};return ce(()=>{se(),ae(),document.addEventListener("visibilitychange",z)}),ve(()=>{m&&clearInterval(m),document.removeEventListener("visibilitychange",z)}),(r,e)=>{const v=f("el-tag"),V=f("el-icon"),le=f("el-progress"),H=f("el-radio"),D=f("el-radio-group"),oe=f("el-checkbox"),ne=f("el-checkbox-group"),re=f("el-input"),x=f("el-button"),F=f("el-dialog");return u(),p("div",Ce,[t("div",Ee,[t("div",xe,[t("h2",null,l(k.title),1),t("div",we,[s(v,{type:"info"},{default:a(()=>[c(l(k.category),1)]),_:1}),s(v,{type:"warning"},{default:a(()=>[c(l(k.level),1)]),_:1}),s(v,null,{default:a(()=>[c("总分："+l(k.totalScore)+"分",1)]),_:1})])]),t("div",Ie,[t("div",Se,[s(V,null,{default:a(()=>[s(L(fe))]),_:1}),e[7]||(e[7]=t("span",{class:"time-text"},"剩余时间",-1)),t("span",{class:N(["time-value",{"time-warning":C.value<600}])},l(W.value),3)])])]),t("div",he,[s(le,{percentage:U.value,color:$.value,"stroke-width":8},null,8,["percentage","color"]),t("span",Ve,"已完成 "+l(h.value)+"/"+l(y.value)+" 题",1)]),n.value?(u(),p("div",Le,[t("div",Te,[t("div",Ae,[t("span",Re,"第 "+l(_.value+1)+" 题",1),s(v,{type:J(n.value.type)},{default:a(()=>[c(l(j(n.value.type)),1)]),_:1},8,["type"]),t("span",qe,l(n.value.score)+" 分",1)]),t("div",Ue,[t("p",He,l(n.value.content),1)]),n.value.type==="SINGLE_CHOICE"?(u(),p("div",Oe,[s(D,{modelValue:i[n.value.id],"onUpdate:modelValue":e[0]||(e[0]=o=>i[n.value.id]=o),size:"large"},{default:a(()=>[(u(!0),p(M,null,B(n.value.options,(o,g)=>(u(),R(H,{key:g,label:o.key,class:"answer-option"},{default:a(()=>[t("span",Ne,l(o.key),1),t("span",Me,l(o.value),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])):S("",!0),n.value.type==="MULTIPLE_CHOICE"?(u(),p("div",Be,[s(ne,{modelValue:i[n.value.id],"onUpdate:modelValue":e[1]||(e[1]=o=>i[n.value.id]=o)},{default:a(()=>[(u(!0),p(M,null,B(n.value.options,(o,g)=>(u(),R(oe,{key:g,label:o.key,class:"answer-option"},{default:a(()=>[t("span",Qe,l(o.key),1),t("span",ze,l(o.value),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])):S("",!0),n.value.type==="TRUE_FALSE"?(u(),p("div",De,[s(D,{modelValue:i[n.value.id],"onUpdate:modelValue":e[2]||(e[2]=o=>i[n.value.id]=o),size:"large"},{default:a(()=>[s(H,{label:"true",class:"answer-option"},{default:a(()=>[...e[8]||(e[8]=[t("span",{class:"option-key"},"✓",-1),t("span",{class:"option-text"},"正确",-1)])]),_:1}),s(H,{label:"false",class:"answer-option"},{default:a(()=>[...e[9]||(e[9]=[t("span",{class:"option-key"},"✗",-1),t("span",{class:"option-text"},"错误",-1)])]),_:1})]),_:1},8,["modelValue"])])):S("",!0),n.value.type==="SHORT_ANSWER"?(u(),p("div",Fe,[s(re,{modelValue:i[n.value.id],"onUpdate:modelValue":e[3]||(e[3]=o=>i[n.value.id]=o),type:"textarea",rows:8,placeholder:"请输入您的答案...",maxlength:"1000","show-word-limit":""},null,8,["modelValue"])])):S("",!0)]),t("div",Pe,[s(x,{onClick:X,disabled:_.value===0,size:"large"},{default:a(()=>[s(V,null,{default:a(()=>[s(L(ye))]),_:1}),e[10]||(e[10]=c(" 上一题 ",-1))]),_:1},8,["disabled"]),_.value<y.value-1?(u(),R(x,{key:0,type:"primary",onClick:Y,size:"large"},{default:a(()=>[e[11]||(e[11]=c(" 下一题 ",-1)),s(V,null,{default:a(()=>[s(L(ge))]),_:1})]),_:1})):(u(),R(x,{key:1,type:"success",onClick:ee,size:"large"},{default:a(()=>[s(V,null,{default:a(()=>[s(L(ke))]),_:1}),e[12]||(e[12]=c(" 提交试卷 ",-1))]),_:1}))])])):S("",!0),t("div",Ge,[e[13]||(e[13]=t("h3",null,"答题卡",-1)),t("div",$e,[(u(!0),p(M,null,B(b.value,(o,g)=>(u(),p("div",{key:o.id,class:N(["question-nav-item",{current:g===_.value,answered:K(o.id)}]),onClick:lt=>Z(g)},l(g+1),11,We))),128))]),e[14]||(e[14]=pe('<div class="nav-legend" data-v-b7e38f63><span class="legend-item" data-v-b7e38f63><i class="dot current" data-v-b7e38f63></i>当前题</span><span class="legend-item" data-v-b7e38f63><i class="dot answered" data-v-b7e38f63></i>已作答</span><span class="legend-item" data-v-b7e38f63><i class="dot unanswered" data-v-b7e38f63></i>未作答</span></div>',1))]),s(F,{modelValue:E.value,"onUpdate:modelValue":e[5]||(e[5]=o=>E.value=o),title:"提交确认",width:"500px",center:""},{footer:a(()=>[s(x,{onClick:e[4]||(e[4]=o=>E.value=!1)},{default:a(()=>[...e[17]||(e[17]=[c("继续答题",-1)])]),_:1}),s(x,{type:"primary",onClick:Q,loading:q.value},{default:a(()=>[...e[18]||(e[18]=[c(" 确认提交 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[t("div",je,[s(V,{class:"warning-icon"},{default:a(()=>[s(L(be))]),_:1}),e[16]||(e[16]=t("p",null,"您确定要提交试卷吗？",-1)),t("p",Je,[e[15]||(e[15]=c(" 已答题目：",-1)),t("strong",null,l(h.value),1),c(" / "+l(y.value)+" 题 ",1)]),h.value<y.value?(u(),p("p",Ke," 还有 "+l(y.value-h.value)+" 道题目未作答！ ",1)):S("",!0)])]),_:1},8,["modelValue"]),s(F,{modelValue:A.value,"onUpdate:modelValue":e[6]||(e[6]=o=>A.value=o),title:"考试结果",width:"600px",center:"","close-on-click-modal":!1},{footer:a(()=>[s(x,{type:"primary",onClick:te},{default:a(()=>[...e[20]||(e[20]=[c("返回认证中心",-1)])]),_:1})]),default:a(()=>[t("div",Xe,[t("div",{class:N(["result-score",{pass:d.passed,fail:!d.passed}])},[t("div",Ye,[t("span",Ze,l(d.score),1),e[19]||(e[19]=t("span",{class:"score-label"},"分",-1))])],2),t("div",et,[s(v,{type:d.passed?"success":"danger",size:"large"},{default:a(()=>[c(l(d.passed?"恭喜通过！":"未通过"),1)]),_:1},8,["type"])]),t("div",tt,[t("p",null,"总题数："+l(y.value)+" 题",1),t("p",null,"正确题数："+l(d.correctCount)+" 题",1),t("p",null,"及格分数："+l(k.passScore)+" 分",1)])])]),_:1},8,["modelValue"])])}}},rt=ue(st,[["__scopeId","data-v-b7e38f63"]]);export{rt as default};
