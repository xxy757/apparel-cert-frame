import{_ as U,y as P,r as F,z as k,A as S,o as B,B as T,e as u,f as q,g as E,h as n,i as l,w as s,E as p,n as b,C as x}from"./index-a65af770.js";import{r as L}from"./request-32baecc7.js";const M={name:"Login",setup(){const y=P(),e=F(!1),V=F("personal"),o=k({username:"",password:""}),t=k({username:"",password:""}),d=F(null),a=F(null),i={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},m=async r=>{const f=r==="personal"?d:a,R=r==="personal"?o:t;if(!f.value){p.error("表单未加载");return}f.value.validate(async C=>{if(!C)return p.error("请填写完整的登录信息"),!1;e.value=!0;try{const _=r==="personal"?"/auth/login/personal":"/auth/login/enterprise",g=await L.post(_,{username:R.username,password:R.password});if(g.data&&g.data.token){localStorage.setItem("token",g.data.token),localStorage.setItem("userType",r),localStorage.setItem("userId",g.data.userId||g.data.id||""),localStorage.setItem("username",R.username),p.success("登录成功");const I=r==="personal"?"/personal/resume":"/enterprise/job";y.replace(I)}else p.error("登录失败：返回数据格式错误")}catch(_){console.error("登录失败:",_),p.error(_.message||"登录失败，请检查用户名和密码")}finally{e.value=!1}})},v=r=>{r==="personalForm"?(d.value.resetFields(),o.password=""):(a.value.resetFields(),t.password="")},w=()=>{p.info("忘记密码功能开发中")},c=()=>{o.username="",o.password="",t.username="",t.password="",d.value&&d.value.clearValidate(),a.value&&a.value.clearValidate()};return S(V,(r,f)=>{f==="personal"?(o.username="",o.password="",d.value&&d.value.clearValidate()):f==="enterprise"&&(t.username="",t.password="",a.value&&a.value.clearValidate())}),B(()=>{localStorage.removeItem("savedPassword"),localStorage.removeItem("savedUsername"),c()}),T(()=>{c()}),{activeTab:V,loading:e,personalForm:o,enterpriseForm:t,personalFormRef:d,enterpriseFormRef:a,rules:i,login:m,resetForm:v,forgetPassword:w}}},N={class:"login-container"},A={class:"login-box"},j={class:"login-tabs"},z={class:"login-actions"},D={class:"login-footer"},G={class:"login-actions"},H={class:"login-footer"};function J(y,e,V,o,t,d){const a=u("el-input"),i=u("el-form-item"),m=u("el-button"),v=u("el-form"),w=u("el-tab-pane"),c=u("el-tabs");return q(),E("div",N,[n("div",A,[e[17]||(e[17]=n("h2",null,"服装行业人才技能认证与招聘服务平台",-1)),n("div",j,[l(c,{modelValue:o.activeTab,"onUpdate:modelValue":e[10]||(e[10]=r=>o.activeTab=r),type:"card"},{default:s(()=>[l(w,{label:"个人登录",name:"personal"},{default:s(()=>[l(v,{ref:"personalFormRef",model:o.personalFormRef,rules:o.rules,"label-width":"80px"},{default:s(()=>[l(i,{label:"用户名",prop:"username"},{default:s(()=>[l(a,{modelValue:o.personalFormRef.username,"onUpdate:modelValue":e[0]||(e[0]=r=>o.personalFormRef.username=r),placeholder:"请输入用户名",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(i,{label:"密码",prop:"password"},{default:s(()=>[l(a,{modelValue:o.personalFormRef.password,"onUpdate:modelValue":e[1]||(e[1]=r=>o.personalFormRef.password=r),type:"password",placeholder:"请输入密码",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),l(i,null,{default:s(()=>[n("div",z,[l(m,{type:"primary",onClick:e[2]||(e[2]=r=>o.login("personal")),loading:o.loading},{default:s(()=>[...e[11]||(e[11]=[b("登录",-1)])]),_:1},8,["loading"]),l(m,{onClick:e[3]||(e[3]=r=>o.resetForm("personalForm"))},{default:s(()=>[...e[12]||(e[12]=[b("重置",-1)])]),_:1})])]),_:1}),n("div",D,[n("a",{href:"#",onClick:e[4]||(e[4]=x((...r)=>o.forgetPassword&&o.forgetPassword(...r),["prevent"]))},"忘记密码？"),e[13]||(e[13]=n("a",{href:"/register",style:{"margin-left":"20px"}},"立即注册",-1))])]),_:1},8,["model","rules"])]),_:1}),l(w,{label:"企业登录",name:"enterprise"},{default:s(()=>[l(v,{ref:"enterpriseFormRef",model:o.enterpriseFormRef,rules:o.rules,"label-width":"80px"},{default:s(()=>[l(i,{label:"用户名",prop:"username"},{default:s(()=>[l(a,{modelValue:o.enterpriseFormRef.username,"onUpdate:modelValue":e[5]||(e[5]=r=>o.enterpriseFormRef.username=r),placeholder:"请输入用户名",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(i,{label:"密码",prop:"password"},{default:s(()=>[l(a,{modelValue:o.enterpriseFormRef.password,"onUpdate:modelValue":e[6]||(e[6]=r=>o.enterpriseFormRef.password=r),type:"password",placeholder:"请输入密码",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),l(i,null,{default:s(()=>[n("div",G,[l(m,{type:"primary",onClick:e[7]||(e[7]=r=>o.login("enterprise")),loading:o.loading},{default:s(()=>[...e[14]||(e[14]=[b("登录",-1)])]),_:1},8,["loading"]),l(m,{onClick:e[8]||(e[8]=r=>o.resetForm("enterpriseForm"))},{default:s(()=>[...e[15]||(e[15]=[b("重置",-1)])]),_:1})])]),_:1}),n("div",H,[n("a",{href:"#",onClick:e[9]||(e[9]=x((...r)=>o.forgetPassword&&o.forgetPassword(...r),["prevent"]))},"忘记密码？"),e[16]||(e[16]=n("a",{href:"/register",style:{"margin-left":"20px"}},"立即注册",-1))])]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue"])])])])}const Q=U(M,[["render",J],["__scopeId","data-v-5579d8c3"]]);export{Q as default};
